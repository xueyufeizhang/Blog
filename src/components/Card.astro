---
import { formatDate } from '@/utils/data.util';
import Tags from './Tags.astro';

interface Props {
	post: any;
}

const { post } = Astro.props;
const isPinned = post.frontmatter.isPinned === true;

const fileUrl = post.file;
const slug = fileUrl.split('/').slice(-2, -1)[0]; 
const cleanUrl = `/posts/${slug}`; // 构建最终的浏览器访问路径
---

<a href={cleanUrl}>
	<div
		class="h-full rounded-2xl bg-stone-200/50 from-orange-900 via-amber-700 to-white p-[1px] text-sm shadow-[inset_0_0_0_1px_rgba(255,255,255,0.4)] hover:bg-gradient-to-r dark:bg-gray-900"
	>
		<div
			class="flex h-full w-full flex-col rounded-[1rem] bg-stone-300 p-4 text-gray-900 opacity-90 dark:bg-stone-800 dark:text-white"
		>
			<div class="flex-auto">
				<div class="flex flex-col justify-between gap-2 pb-4 text-xs">
					<div class="flex items-center gap-2">
						{isPinned && (
							<span class="flex items-center gap-1 font-bold text-orange-600 dark:text-orange-400">
								<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
									<path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path>
									<line x1="12" y1="17" x2="12" y2="22"></line>
								</svg>
							</span>
						)}
						<p>{formatDate(post.frontmatter.pubDate)}</p>
					</div>
					<div>
						<p class="font-bold">{post.frontmatter.minutesRead}</p>
					</div>
				</div>

				<p class="pb-4 text-lg font-bold">{post.frontmatter.title}</p>

				<Tags tags={post.frontmatter.tags} />
				<p class="line-clamp-6 pt-4">{post.frontmatter.excerpt}</p>
			</div>
			<p class="pt-4 underline">read more →</p>
		</div>
	</div>
</a>
